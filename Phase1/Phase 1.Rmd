## Project Phase 1

Mira Madi & Rita Rizkallah

## 1-About Dataset

This dataset can used to predict possibility or risk of getting other diseases.This includes the details of individuals having various disorders.Very useful for corona risk prediction. It has attributes like age, diabetes, cancer, etc. The dataset is from kaggle.
Outcome: risk of getting another disease.

## 2-Data Preprocessing

Data preprocessing is important because it ensures that the data is clean and that we end up with the most accurate results possible.

First, we set the working directory, read the dataset file and view it.

```{r pressure, echo=FALSE}
setwd("C:/Users/MSI/OneDrive - Lebanese American University/Desktop/BIF524 Project") 
df <- read.csv("Diseases.csv")
View(df)
```

Then, we invoked the str function which provides a summary of the dataset, including its type, the number of observations, and variables (attributes). It also gives the type of each attribute.

We also invoked the summary function which gives the "5-number summary", for our data it is only relevant for the age and bmi attributes, since the rest are qualitative attributes

colnames(df) prints out the names of the columns which represent the attributes.

```{r pressure, echo=FALSE}
str(df)
summary(df)
colnames(df)
```

In order to check for missing values, we first invoke the dim function which gives the number of observations and the number of attributes, then invoke the na.omit function which removes missing values and then we recheck using dim function, the result did not change meaning that we don't have any missing values.
This ensures that our data is complete!

```{r pressure, echo=FALSE}
dim(df)
df <- na.omit(df)
dim(df)
```

If duplicates are present, it is always better if they are removed, as they can introduce correlated error terms, which lead to the prediction intervals being narrower than
they should be. So we invoked duplicated function which showed that we had 2 rows that are duplicated, to remove them we used !duplicated function and saved the result to a new dataframe.

```{r pressure, echo=FALSE}
df[duplicated(df), ]
```

```{r pressure, echo=FALSE}
df_unique <- df[!duplicated(df), ]
df_unique[duplicated(df_unique), ]
View(df_unique)
```

We suspect that there is a correlation between a high BMI and an increased risk of diabetes, thus we created a subset of data taking BMI > 25, and this showed that our doubts might be correct.

```{r pressure, echo=FALSE}
subset_BMI <- subset(df_unique, BMI > 25)
View(subset_BMI)
```

To check if we have logical values of age and BMI we ran the function unique. It showed the possible values for age and BMI that are present in our data and it seems that they are all within the normal range of logical values, thus we do not have any unexpected random values.

```{r pressure, echo=FALSE}
unique(df_unique$Age)
unique(df_unique$BMI)
```
## 3-Data Visualization

```{r pressure, echo=FALSE}
df_unique_long <- df_unique %>%
  pivot_longer(
    cols = c(Diabetes, Cardio_Vascular_Diseases, Sickle_cell_diesases, Immuno_deficiency_disease, 
             Down_syndrome, Cancer, Chronic_Respiratory_disease, Hypertension), 
    names_to = "Condition", 
    values_to = "Has_Condition"
  )

df_unique_long <- df_unique_long[df_unique_long$Has_Condition == 1, ]
ggplot(df_unique_long, aes(x = Gender, fill = Condition)) +
  geom_bar(position = "stack") +
  labs(title = "Stacked Bar Graph of Chronic Conditions by Gender",
       x = "Gender", y = "Count of Conditions") +
  theme_minimal()
```
This stacked bar graph shows the different diseases' distributions between females and males. We see that there is a minor difference between females and males in general, as both have almost equal number of cases.

```{r pressure, echo=FALSE}
ggplot(df_unique, aes(x = Gender, fill = factor(Cardio_Vascular_Diseases))) +
  geom_bar(position = "dodge") +
  labs(
    title = "Grouped Bar Chart of Cardiovascular Disease by Gender",
    x = "Gender",
    y = "Count",
    fill = "Cardio Vascular Disease"
  ) +
  scale_fill_manual(values = c("0" = "lightgray", "1" = "steelblue"),
                    labels = c("No", "Yes")) +
  theme_minimal()
```
This grouped bar chart shows count of presence and absence of CVD for Females and Males. It shows that more males have CVD vs females, this does not seem to be significant but further analysis such as statistical test are needed.

```{r pressure, echo=FALSE}
ggplot(df_unique, aes(x = factor(Diabetes), y = BMI, fill = factor(Diabetes))) +
  geom_boxplot(outlier.colour = "red", outlier.size = 2) +  # Optional: Highlight outliers
  labs(
    title = "Box Plot of BMI by Diabetes Status",
    x = "Diabetes (0 = No, 1 = Yes)",
    y = "BMI",
    fill = "Diabetes"
  ) +
  scale_fill_manual(values = c("0" = "lightblue", "1" = "lightcoral")) +
  theme_minimal()
```

This box plot shows the 5-number summary for Diabetes (present (1) or absent (0)) in function of BMI level. While the median BMI is slightly higher in individuals with diabetes, there is no significant difference in the overall distribution of BMI between the two groups. However, the presence of outliers suggests that some individuals with diabetes may have extreme BMI values.

```{r pressure, echo=FALSE}
ggplot(data = df_unique, aes(x = Vaccinated)) +
  geom_histogram(fill = "magenta", color = "black", bins = 3) +
  labs(x = "Vaccinated", y = "Frequency") +
  scale_x_continuous(breaks = c(0, 1)) +
  theme_minimal()
```
The bar chart shows the frequency of individuals who are vaccinated (1) and not vaccinated (0). The height of each bar represents the number of individuals in each category. From the chart, it appears that there are more individuals who are vaccinated than not vaccinated.

```{r pressure, echo=FALSE}
df_unique$Gender <- as.numeric(factor(df_unique$Gender))
correlations <- corr.test(df_unique)
corr_matrix <- correlations$r
corrplot(corr_matrix, method = "color", type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
```

This correlation matrix shows all possible correlations and the level of correlation ranging from -1 (dark red) to 1 (dark blue). There seems to be some kind of correlation between all the different types of diseases with the outcome, being the risk of getting another disease. For example, there seems to be little correlation between cardiovascular diseases and the risk of getting another disease, while others like down sydrome and chronic respiratory disease have a higher correlation with the outcome. BMI has no correlation with the outcome, but age and gender do have a somewhat low correlation with it. Moreover there seems to be a positive correlation between cancer and sickle cell diseases as well as between Down syndrome and and immuno dificiency disease.These can be used as interaction terms when we generate our model. The matrix also shows a negative correlation between diabetes and sickle cell diseases, as well as cancer. All in all, there is a need to generate multiple linear regression models, including interaction terms.


## 4-Simple Linear Regression

1) Age vs Outcome

```{r pressure, echo=FALSE}
install.packages("ggplot2")
library(ggplot2)
ggplot(data=df_unique)+
  geom_point(mapping=aes(x=`Age`,y=`Outcome`))+ 
  geom_smooth(mapping=aes(x=`Age`,y=`Outcome`))




```


